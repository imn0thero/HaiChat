<!DOCTYPE html>
<html lang="id">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Homemade+Apple&display=swap" rel="stylesheet">
Â  <link rel="stylesheet" href="style.css" />
Â  <title>HaiChat</title>
</head>
<body>
Â  <div class="container">
Â  Â  <h2 id="welcome"></h2>

Â  Â  <div>
Â  Â  Â  <h3>Pengguna Online:</h3>
Â  Â  Â  <div id="onlineUsers"></div>
Â  Â  </div>

Â  Â  <div id="chatbox"></div>

Â  Â  <div id="inputArea">
Â  Â  Â  <input type="text" id="msgInput" placeholder="Tulis pesan..." />
Â  Â  Â  <button onclick="sendMessage()">Kirim</button>
Â  Â  </div>
Â  Â  <button onclick="logout()">Logout</button>
Â  </div>

Â  <script src="/socket.io/socket.io.js"></script>
Â  <script>
Â  Â  const username = localStorage.getItem('username');
Â  Â  const password = localStorage.getItem('password');

Â  Â  if (!username || !password) {
Â  Â  Â  window.location.href = 'login.html';
Â  Â  }

Â  Â  document.getElementById('welcome').innerText = "Hai, " + username;

Â  Â  const socket = io();
Â  Â  socket.emit('login', { username, password });

Â  Â  socket.on('message', data => {
Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  div.classList.add('message');

Â  Â  Â  if (data.user === username) {
Â  Â  Â  Â  div.classList.add('message-right');
Â  Â  Â  } else {
Â  Â  Â  Â  div.classList.add('message-left');
Â  Â  Â  }

Â  Â  Â  div.innerHTML = `<strong>${data.user}:</strong><br>${data.text}`;

Â  Â  Â  document.getElementById('chatbox').appendChild(div);
Â  Â  Â  document.getElementById('chatbox').scrollTop = document.getElementById('chatbox').scrollHeight;
Â  Â  });

Â  Â  socket.on('userList', users => {
Â  Â  Â  const userList = users.map(user => `<li>${user} ðŸ”µ</li>`).join('');
Â  Â  Â  document.getElementById('onlineUsers').innerHTML = "<ul>" + userList + "</ul>";
Â  Â  });

Â  Â  function sendMessage() {
Â  Â  Â  const text = document.getElementById('msgInput').value.trim();

Â  Â  Â  if (text) {
Â  Â  Â  Â  socket.emit('message', { text });
Â  Â  Â  Â  document.getElementById('msgInput').value = '';
Â  Â  Â  }
Â  Â  }

Â  Â  function logout() {
Â  Â  Â  localStorage.removeItem('username');
Â  Â  Â  localStorage.removeItem('password');
Â  Â  Â  socket.emit('logout');
Â  Â  Â  window.location.href = 'login.html';
Â  Â  }
Â  </script>
</body>
</html>
